<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>888流量電商體驗課報名表</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* 網頁整體樣式設定 */
        body {
            font-family: 'Noto Sans TC', sans-serif; /* 使用 Google 中文字體 */
            background-color: #f4f7f6; /* 淡灰色背景 */
            display: flex;
            justify-content: center; /* 水平居中 */
            align-items: flex-start; /* 內容從頂部開始 */
            min-height: 100vh; /* 最小高度為視窗高度 */
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        /* 表單容器樣式 */
        .form-container {
            background-color: #ffffff; /* 白色表單背景 */
            padding: 40px;
            border-radius: 8px; /* 圓角邊框 */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* 輕微陰影效果 */
            width: 100%;
            max-width: 760px; /* 表單最大寬度，調整以適應內容 */
            box-sizing: border-box;
        }
        /* 主標題樣式 */
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em; /* 字體大小 */
            font-weight: 700; /* 字體粗細 */
        }
        /* 副標題樣式 */
        h2 {
            text-align: center;
            color: #555;
            margin-bottom: 30px;
            font-size: 1.5em;
            font-weight: 400;
        }
        /* 表單每個輸入組的樣式 */
        .form-group {
            margin-bottom: 20px;
            padding: 15px 20px;
            border: 1px solid #ddd; /* 淺灰色邊框 */
            border-radius: 5px;
        }
        /* 某些區塊不需要邊框時使用 */
        .form-group.no-border {
            border: none;
            padding: 0;
        }
        /* 標籤 (label) 樣式 */
        label {
            display: block; /* 讓標籤獨佔一行 */
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 1.1em;
        }
        /* 必填欄位星號標示 */
        .required::after {
            content: ' *'; /* 在必填標籤後方顯示紅色星號 */
            color: red;
        }
        /* 輸入框、下拉選單、文字區塊的樣式 */
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        textarea,
        select {
            width: 100%; /* 寬度佔滿父容器 */
            padding: 12px 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box; /* 包含內邊距和邊框在寬度內 */
            font-size: 1em;
            color: #333;
            transition: border-color 0.3s ease; /* 平滑過渡效果 */
        }
        /* 輸入框獲得焦點時的樣式 */
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        textarea:focus,
        select:focus {
            border-color: #4CAF50; /* 綠色高亮 */
            outline: none; /* 移除瀏覽器預設的外框 */
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.3); /* 輕微陰影 */
        }
        /* 文字區塊 (備註) 樣式 */
        textarea {
            resize: vertical; /* 只允許垂直調整大小 */
            min-height: 100px;
        }
        /* 單選和多選選項組的間距 */
        .radio-group, .checkbox-group {
            margin-top: 10px;
        }
        /* 單選和多選選項的標籤及輸入框對齊 */
        .radio-group label, .checkbox-group label {
            display: flex;
            align-items: center; /* 垂直居中對齊 */
            font-weight: 400;
            margin-bottom: 8px;
            cursor: pointer;
        }
        /* 單選和多選輸入框的樣式 */
        .radio-group input[type="radio"], .checkbox-group input[type="checkbox"] {
            width: auto; /* 自動寬度 */
            margin-right: 10px; /* 與文字的間距 */
            transform: scale(1.2); /* 放大選框 */
        }
        /* 資訊文字區塊樣式 (例如：條款聲明) */
        .info-text {
            font-size: 0.95em;
            color: #666;
            line-height: 1.6; /* 行高 */
            margin-top: 15px;
            margin-bottom: 25px;
            background-color: #f8f8f8; /* 淺灰色背景 */
            border-left: 4px solid #eee; /* 左邊框 */
            padding: 15px;
            border-radius: 4px;
        }

        /* 送出按鈕樣式 */
        button {
            background-color: #4CAF50; /* 綠色按鈕 */
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 700;
            width: 100%;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }
        button:hover {
            background-color: #45a049; /* 滑鼠懸停時顏色變深 */
        }
        button:disabled {
            background-color: #a0a0a0; /* 禁用時變灰 */
            cursor: not-allowed;
        }
        /* 回應訊息區塊樣式 */
        #response-message {
            margin-top: 25px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            padding: 10px;
            border-radius: 5px;
            display: none; /* 預設隱藏，只在有訊息時顯示 */
        }
        /* 成功訊息樣式 */
        .success-message {
            color: #28a745;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        /* 錯誤訊息樣式 */
        .error-message {
            color: #dc3545;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        /* 載入訊息樣式 */
        .loading-message {
            color: #007bff;
            background-color: #e0f2f7;
            border-color: #b3e0ff;
        }
        /* LINE 加入區塊樣式 */
        .line-join-section {
            margin-top: 20px;
            padding: 20px;
            background-color: #e6ffe6; /* 淡綠色背景 */
            border: 1px solid #4CAF50; /* 綠色邊框 */
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        .line-join-section h3 {
            color: #28a745;
            margin-bottom: 5px;
            font-size: 1.4em;
        }
        .line-join-section p {
            font-size: 1.1em;
            color: #333;
            text-align: center;
            line-height: 1.5;
        }
        .line-join-section a.line-button {
            display: inline-block;
            background-color: #00C300; /* LINE 綠色 */
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            text-decoration: none;
            font-size: 1.2em;
            font-weight: bold;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 195, 0, 0.3);
        }
        .line-join-section a.line-button:hover {
            background-color: #00A700;
        }
        .line-join-section img.qrcode {
            width: 150px; /* QR Code 圖片大小 */
            height: 150px;
            border: 5px solid white; /* 白色邊框 */
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

<div class="form-container">
    <h1>888流量電商體驗課報名表</h1>
    <h2>888流量電商體驗課報名資訊</h2>
    <form id="registrationForm">

        <div class="form-group">
            <label for="realName" class="required">真實姓名:</label>
            <input type="text" id="realName" name="真實姓名" placeholder="請輸入您的真實姓名" required>
        </div>

        <div class="form-group">
            <label for="phoneNumber" class="required">手機號碼:</label>
            <input type="tel" id="phoneNumber" name="手機號碼" placeholder="請輸入您的手機號碼" required>
        </div>

        <div class="form-group">
            <label for="lineID">LINE ID:</label>
            <input type="text" id="lineID" name="LINE ID" placeholder="請輸入您的 LINE ID (選填)">
        </div>

        <div class="form-group">
            <label for="industry" class="required">產業別:</label>
            <select id="industry" name="產業別" required>
                <option value="">-- 請選擇您的產業別 --</option>
                <option value="電商/零售業">電商/零售業</option>
                <option value="服務業">服務業</option>
                <option value="餐飲業">餐飲業</option>
                <option value="教育/培訓業">教育/培訓業</option>
                <option value="媒體/娛樂業">媒體/娛樂業</option>
                <option value="製造業">製造業</option>
                <option value="金融/保險業">金融/保險業</option>
                <option value="醫療/健康產業">醫療/健康產業</option>
                <option value="科技/軟體業">科技/軟體業</option>
                <option value="房地產/建築業">房地產/建築業</option>
                <option value="政府/非營利組織">政府/非營利組織</option>
                <option value="學生">學生</option>
                <option value="其他">其他</option>
            </select>
        </div>

        <div class="form-group">
            <label for="currentRole" class="required">目前的角色:</label>
            <select id="currentRole" name="目前的角色" required>
                <option value="">-- 請選擇您的角色 --</option>
                <option value="小白 / 想了解如何用電商和自媒體變現">小白 / 想了解如何用電商和自媒體變現</option>
                <option value="電商 / 遇到瓶頸 想了解如何降本增效">電商 / 遇到瓶頸 想了解如何降本增效</option>
                <option value="團購主 / 想了解如何取得第一手貨源">團購主 / 想了解如何取得第一手貨源</option>
                <option value="自媒體創作者 / 有流量卻不知道怎麼變現">自媒體創作者 / 有流量卻不知道怎麼變現</option>
                <option value="實體店經營者 / 不想大量再囤貨">實體店經營者 / 不想大量再囤貨</option>
                <option value="廠商 / 想要對接更多的零售端">廠商 / 想要對接更多的零售端</option>
            </select>
        </div>

        <div class="form-group">
            <label for="currentBottleneck" class="required">目前遇到的瓶頸:</label>
            <select id="currentBottleneck" name="目前遇到的瓶頸" required>
                <option value="">-- 請選擇您遇到的瓶頸 --</option>
                <option value="營業額難以提高">營業額難以提高</option>
                <option value="利潤不足">利潤不足</option>
                <option value="人員培養困難">人員培養困難</option>
                <option value="稅務問題">稅務問題</option>
                <option value="自有流量取得困難">自有流量取得困難</option>
                <option value="採購進貨相關問題">採購進貨相關問題</option>
                <option value="其他">其他</option>
            </select>
        </div>

        <div class="form-group">
            <label class="required">最感興趣的部分 (可複選):</label>
            <div class="checkbox-group">
                <label><input type="checkbox" name="最感興趣的部分" value="短影音定位及起號"> 短影音定位及起號</label>
                <label><input type="checkbox" name="最感興趣的部分" value="短影音矩陣切片&TK投流"> 短影音矩陣切片&TK投流</label>
                <label><input type="checkbox" name="最感興趣的部分" value="蝦皮電商經營技巧"> 蝦皮電商經營技巧</label>
                <label><input type="checkbox" name="最感興趣的部分" value="第一手貨源對接"> 第一手貨源對接</label>
                <label><input type="checkbox" name="最感興趣的部分" value="物流渠道 集運代理"> 物流渠道 集運代理</label>
                <label><input type="checkbox" name="最感興趣的部分" value="大陸電話卡及銀行卡開戶"> 大陸電話卡及銀行卡開戶</label>
                <label><input type="checkbox" name="最感興趣的部分" value="介紹分潤"> 介紹分潤</label>
            </div>
             <input type="hidden" name="dummy_interest_required" data-required-checkbox-group="最感興趣的部分">
        </div>

        <div class="form-group">
            <label for="emailAddr" class="required">Email:</label>
            <input type="email" id="emailAddr" name="Email" placeholder="請輸入您的Email地址" required>
        </div>

        <div class="form-group">
            <label for="referrerName">介紹人姓名 (選填):</label>
            <input type="text" id="referrerName" name="介紹人姓名" placeholder="若有介紹人，請輸入其姓名">
        </div>

        <div class="form-group no-border">
            <div class="info-text" style="font-size:0.85em; background-color:#fff0f5; border-left-color:#ffb6c1;">
                <p style="font-weight:bold; color:#dc3545;">📜 課程報名條款與免責聲明（請務必詳閱）</p>
                <p>本課程為付費知識型教學活動，請學員於報名前詳細閱讀下列條款。<br>勾選同意並完成付款，即表示您已完全理解並接受以下內容：</p>
                <p style="font-weight:bold; color:#555;">課程性質說明</p>
                <p>本課程主題為電商經營與自媒體引流變現相關，課程內容為知識傳授、實務經驗分享與操作思維建構。<br>主辦單位已盡責提供完整課程內容，完成課程即視為已履行服務。</p>
                <p style="font-weight:bold; color:#555;">成果與應用免責聲明</p>
                <p>成果取決於個人背景、資源、執行力與實際操作狀況，與本課程本身無關。<br>若學員課後無法成功應用內容，或未獲期望成效，皆屬個人執行與學習結果問題，主辦單位不負責任亦不提供補償或個別協助。</p>
                <p style="font-weight:bold; color:#555;">付款與退費政策</p>
                <p>本課程採一次性付費、報名後恕不退費、不轉讓、不保留名額，不論任何理由（包括但不限於個人因素、臨時無法參與等）。<br>課程上完即視為服務結束，不提供後續個別諮詢、教學或技術輔導。</p>
                <p style="font-weight:bold; color:#555;">社群參與說明</p>
                <p>課程結束後，主辦單位可能提供社群平台供學員進行互動與經驗交流，此為非營利性質的延伸服務，並不構成一對一教學或售後輔導義務。<br>社群管理與活動內容由主辦單位視情況安排，不保證特定頻率或回覆承諾。</p>
                <p style="font-weight:bold; color:#555;">智慧財產權保護</p>
                <p>課程中所提供之教材、簡報、影片等內容均為主辦單位【凱迪拉課整合行銷國際有限公司】或講師之智慧財產，未經授權不得翻錄、公開分享、轉賣、改作或散播，違者將依法追究。</p>
                <p style="font-weight:bold; color:#555;">保密協議條款</p>
                <p>本課程內容（包括但不限於文字、圖片、影片、教材、講義、教學方法、討論內容等），以及主辦單位所建立或使用之 官方LINE群組、交流社群平台（包括但不限於LINE、Facebook社團、threads、Telegram、WhatsApp、Email通訊、私訊對話）及其他相關溝通管道 內之言論與分享內容，均屬【凱迪拉課整合行銷國際有限公司】及講師之智慧財產或受保護資訊，僅供學員本人學習使用及內部交流。<br>學員不得以任何形式（包括但不限於錄音、錄影、截圖、翻拍、轉錄、轉載、轉貼、公開分享、轉售或用於其他商業用途）保存、散布、轉傳或提供予第三人，亦不得將社群內任何交流內容、其他學員分享資訊、教學討論內容對外揭露、引用或散播。<br>課程期間與結束後，學員皆須遵守保密義務，不得將課程內容、教材資料、社群交流資訊、其他學員分享內容外流，亦不得改編後作為自行開課、出版或其他營利性用途。<br>違反上述保密條款者，主辦單位有權立即取消學員資格，並依法追究相關法律責任及損害賠償。<br>保密義務自報名付款日起生效，於課程結束後及社群存續期間皆持續有效，不因課程終止或社群解散而解除。</p>
            </div>
        </div>

        <div class="form-group">
            <label class="required"><input type="checkbox" id="termsAgreement" name="條款同意聲明" value="我已詳細閱讀並完全同意以上課程條款、免責聲明及保密協議條款" required> 我已詳細閱讀並完全同意以上課程條款、免責聲明及保密協議條款。</label>
        </div>

        <div class="form-group">
            <label>匯款帳號:</label>
            <p style="font-weight:bold; color:#555; font-size:1.1em;">
                <span style="color:#dc3545;">[請在此處填寫您的銀行匯款資訊，例如：</span><br>
                <span style="color:#dc3545;">銀行名稱：XXX銀行</span><br>
                <span style="color:#dc3545;">戶名：XXX有限公司</span><br>
                <span style="color:#dc3545;">帳號：123-456-789-0 (範例)]</span>
            </p>
        </div>

        <div class="form-group">
            <label for="lastFiveDigits" class="required">匯款帳號末五碼:</label>
            <input type="text" id="lastFiveDigits" name="匯款帳號末五碼" placeholder="請輸入您匯款帳號的末五碼" pattern="\d{5}" title="請輸入五位數字" maxlength="5" required>
        </div>

        <div class="form-group">
            <label for="notes">備註:</label>
            <textarea id="notes" name="備註" placeholder="如果您有任何特殊需求或問題，請在此說明。"></textarea>
        </div>

        <button type="submit" id="submitButton">送出報名</button>
        <div id="response-message"></div>
    </form>
</div>

<script>
    // ***重要：將以下 URL 替換為您在 Google Apps Script 部署後取得的網路應用程式 URL***
    const TEXT_DATA_SERVICE_URL = 'https://script.google.com/macros/s/AKfycbx6LssyHy80s6PicXX73S54Ft5RDwU8wv0H2r4k9jFN3h0cWVFu0st6TK1-rUEuEPxu/exec'; 

    // ***請將這裡替換為您的 LINE 官方帳號加入連結和 QR Code 圖片的公開網址***
    // 您可以上傳 QR Code 圖片到您的 GitHub 儲存庫，然後使用其 Raw 連結
    const LINE_JOIN_LINK = 'https://lin.ee/7vNA7Ee'; // 替換成您的LINE官方帳號加入連結
    const LINE_QR_CODE_IMG_URL = 'https://qr-official.line.me/gs/M_209clywb_GW.png'; // 如果要顯示QR Code，請替換成圖片的公開網址，如果不需要顯示則留空字串 ''

    const registrationForm = document.getElementById('registrationForm');
    const responseMessage = document.getElementById('response-message');
    const submitButton = document.getElementById('submitButton');

    // 主表單提交事件處理函數
    registrationForm.addEventListener('submit', async function(e) {
        e.preventDefault(); // 阻止表單的預設提交行為

        // 顯示載入訊息並禁用提交按鈕
        responseMessage.style.display = 'block';
        responseMessage.className = 'loading-message';
        responseMessage.textContent = '資料驗證中，請稍候...';
        submitButton.disabled = true; // 禁用提交按鈕，防止重複提交

        // --- 前端驗證 ---
        // 1. 檢查必填的多選框組是否至少選擇了一個
        const requiredCheckboxGroups = document.querySelectorAll('input[type="hidden"][data-required-checkbox-group]');
        for (const hiddenInput of requiredCheckboxGroups) {
            const groupName = hiddenInput.dataset.requiredCheckboxGroup;
            const groupCheckboxes = document.querySelectorAll(`input[name="${groupName}"][type="checkbox"]`);
            const isAnyChecked = Array.from(groupCheckboxes).some(cb => cb.checked);
            if (!isAnyChecked) {
                responseMessage.className = 'error-message';
                responseMessage.textContent = `請至少選擇一個「${groupName}」選項。`;
                submitButton.disabled = false;
                return; // 阻止表單提交
            }
        }

        // 2. 檢查「條款同意聲明」是否被勾選
        const termsAgreementCheckbox = document.getElementById('termsAgreement');
        if (!termsAgreementCheckbox.checked) {
            responseMessage.className = 'error-message';
            responseMessage.textContent = '請勾選「我已詳細閱讀並完全同意以上課程條款、免責聲明及保密協議條款」。';
            submitButton.disabled = false;
            return; // 阻止表單提交
        }
        // --- 結束前端驗證 ---

        responseMessage.textContent = '資料送出中，請稍候...';

        const formData = new FormData(registrationForm);

        // 處理多選框 (checkboxes) 的值，將多個選中的值合併為一個逗號分隔的字串
        const allCheckboxes = registrationForm.querySelectorAll('input[type="checkbox"]');
        const checkboxGroupValues = {}; 
        allCheckboxes.forEach(checkbox => {
            // 排除「條款同意聲明」的 checkbox
            if (checkbox.checked && checkbox.id !== 'termsAgreement') { 
                if (!checkboxGroupValues[checkbox.name]) {
                    checkboxGroupValues[checkbox.name] = [];
                }
                checkboxGroupValues[checkbox.name].push(checkbox.value);
            }
        });

        // 將處理過的多選值更新到 formData
        for (const name in checkboxGroupValues) {
            formData.set(name, checkboxGroupValues[name].join(', '));
        }

        // 使用 Fetch API 將表單數據 POST 到 Apps Script (文字數據服務)
        try {
            const response = await fetch(TEXT_DATA_SERVICE_URL, {
                method: 'POST',
                body: formData // 將 FormData 直接作為 body 傳送
            });
            const data = await response.json(); // 解析回傳的 JSON 數據

            if (data.status === 'success') {
                responseMessage.className = 'success-message';
                // 清空表單內容
                registrationForm.reset(); 

                // 動態生成 LINE 加入區塊的內容
                let lineContent = `
                    <p>您的報名已成功送出！</p>
                    <h3>💡 立即加入我們的 LINE 官方帳號，上傳您的匯款憑證！</h3>
                    <p>點擊下方按鈕或掃描 QR Code 即可加入：</p>
                    <a href="${LINE_JOIN_LINK}" target="_blank" class="line-button">加入 LINE 官方帳號</a>
                `;
                // 如果有提供 QR Code 圖片 URL，則加入 QR Code
                if (LINE_QR_CODE_IMG_URL) {
                    lineContent += `<img src="${LINE_QR_CODE_IMG_URL}" alt="LINE QR Code" class="qrcode">`;
                }

                // 將內容設置到 responseMessage 元素中
                responseMessage.innerHTML = lineContent;

                // 添加 LINE 加入區塊的樣式
                responseMessage.classList.add('line-join-section');

            } else {
                responseMessage.className = 'error-message';
                responseMessage.textContent = '報名失敗，請稍後再試。' + (data.message ? ' 錯誤: ' + data.message : '');
                // 移除 LINE 加入區塊的樣式
                responseMessage.classList.remove('line-join-section');
            }
        } catch (error) {
            // 捕獲網路或其他錯誤
            responseMessage.className = 'error-message';
            responseMessage.textContent = '發生網路錯誤，請檢查您的連線或稍後再試。';
            console.error('Text data fetch error:', error);
            // 移除 LINE 加入區塊的樣式
            responseMessage.classList.remove('line-join-section');
        } finally {
            submitButton.disabled = false; // 無論成功或失敗，都重新啟用提交按鈕
        }
    });
</script>

</body>
</html>